<view class="rank">
  
  <view class="rank-poster">
    <xcx-danmu danmuList="{{activity.danmaku}}" height="80" bind:clickText="clickDanmu"/>
    <image mode="aspectFill" src="{{activity.banner}}"/>
    <view class="mask" style="background-color:{{activity.mask}}">
      <view class="mask-bottom flex">
        <text class="peopleNum">{{activity.playerNum}} 人参加</text>
        <view class="border">|</view>
        <view class="rule flex" bindtap="clickRule">
          <image src="/images/icon-tips.png"/> 游戏规则
        </view>
      </view>
    </view>
  </view>
  
  <view class="rank-head">
    <view class="rank-row">
      <view class="rank-num rank-column">排名</view>
      <view class="rank-player rank-column">玩家</view>
      <view class="rank-zhuli rank-column">助力人数</view>
      <view class="rank-score rank-column">分数</view>
    </view>
  </view>

  <scroll-view class="rank-body" scroll-y style="height: {{scrollHeight}}px" bindscrolltolower="scrolltoLower">
    <view wx:for="{{ranks}}" wx:key="{{index}}" class="rank-row">
      <view class="rank-num rank-column {{item.rank<4 ? 'top3' : ''}}">
        <image wx:if="{{item.rank<4}}" src="/images/rank{{item.rank}}.png" />
        <text>{{item.rank}}</text>
      </view>
      <view class="rank-player rank-column">
        <image src="{{item.avatar}}" />
        <text>{{item.name}}</text>
      </view>
      <view class="rank-zhuli rank-column">
        <image src="/images/people-gray.png" />
        <text>{{item.assistanceNum}}</text>
      </view>
      <view class="rank-score rank-column">
        <text>{{item.score}}</text>分
      </view>
    </view>
  </scroll-view>
</view>

<view class="rank-my" wx:if="{{user}}">
  <view>
    <image class="rank-my-avatar" src="{{user.avatar || '../../images/defaultavatar.png'}}" />
    <view wx:if="{{score>=0}}" class="rank-my-result">
      <view><text class="rank-my-score">{{rank}}</text> 名</view>
      <view>{{score}} 分</view>
    </view>
    <view wx:else>未参赛</view>
  </view>
  <view class="rank-my-btns">
    <view class="rank-my-btn-item" bindtap='onHelp' data-aid="{{aid}}">
      <image class="people-white" src="/images/people-white.png" />
      <view>助力</view>
      <view>{{assistanceNum}}</view>
    </view>
    <xcx-navigator nav-class="rank-my-btn-item" game="{{intoGame}}" bindonclick="onStartGame">
      <view>立即参赛</view>
      <image class="rarraw-dot" src="/images/rarrow-dot.png" />
    </xcx-navigator>
  </view>
</view>

<xcx-zhuli show="{{helpShow}}" aid="{{aid}}" bind:deleteHelp="deleteHelp" navBarBGColor="#3c7fea" navBarFontColor='#ffffff' />

<view class="zhuli-pop" wx:if="{{showInvitePop}}">
  <view class='zhuli-pop-box'>
    <view class="zhuli-pop-box-head">
      <view class="zhuli-pop-box-info">
        <image src="https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJcXuypichXUF0JRyVR2Bes61qToddjRIgyEsuQd2Jwb8icuTrU9tJqpdzO5Glv4jP6JffmjxNVrycQ/132"> </image>
        <view>
          <view class="zhuli-pop-box-user">为<text>黑桃九</text>助力</view>
          <view class="zhuli-pop-box-tips">
            我还差200分即可瓜分2万红包~
            <view></view>
          </view>
        </view>
      </view>
      <view class="zhuli-pop-box-btn">
        <view>助力一下</view>
      </view>
    </view>
    <view class="zhuli-pop-close" bindtap='onCloseInvitePop'>
    </view>
  </view>
</view>

<qk-result page-show="{{pageShow}}" navBarBGColor="#3c7fea" navBarFontColor='#ffffff' />

<xcx-login bindonlogin="onLogin" />
